.\" Not automatically generated by Axel Kenzo
.\" 13 Августа, 2021г.
.TH "aktool" "1" "@CURRENT_DATE_STRING@" "aktool, версия @HEAD_VERSION@.@MAIN_VERSION@.@MINOR_VERSION@" "Правила пользования утилитой"

.SH "НАЗВАНИЕ"
aktool - консольная утилита, предназначенная для шифрования и контроля целостности данных.
.SH "СИНТАКСИС"
Синтаксис выполнения программы
.PP
\fBaktool команда\fR [\fIопции\fR] [\fIфайл или каталог\fR]
.PP
.\"
.SH "ОПИСАНИЕ"
.PP
Утилита предоставляет интерфейс к различным криптографическим
преобразованиям таким, как шифрование и контроль целостности данных,
выработка и проверка электронной подписи, генерация криптографических
ключей и паролей, создание и верификация сертификатов открытых ключей.
.PP
Перечисленные преобразования реализуются библиотекой \fBlibakrypt\fR в
соответствии с «Принципами разработки и  модернизации шифровальных
(криптографических) средств защиты информации» для средств
класса КС3.
.PP
Каждая команда определяет отдельный класс криптографических
преобразований и функциональных возможностей. В настоящее время
доступны следующие команды:
.PP
\fBa, asn1parse\fR
.RS 4
Декодирование и печать ASN.1 данных
.RE
\fBi, icode\fR
.RS 4
Вычисление контрольной суммы или имитовставки
.RE
\fBk, key\fR
.RS 4
Управление ключевой информацией
.RE
\fBs, show\fR
.RS 4
Вывод служебной и справочной информации
.RE
\fBtest\fR
.RS 4
Тестирование корректности и скорости работы криптограграфических алгоритмов
.RE
.PP
Получить информацию о доступных опциях и параметрах любой
команды можно с помощью вызова
.PP
\fBaktool \fIкоманда\fR --help
.RE
.\"
.SH "УПРАВЛЕНИЕ КЛЮЧЕВОЙ ИНФОРМАЦИЕЙ"
.SS "Общее описание"
.PP
Команда \fBkey\fR (короткая форма \fBk\fR) позволяет вырабатывать секретные и открытые ключи
для дальнейшего использования в алгоритмах шифрования, контроля целостности,
процедурах выработки и проверки электронной подписи и т.п.
.PP
Поддерживается инфраструктура сертификатов открытых ключей, а также
генерация ключей парной связи (симметричных ключей)
в соответствиии со схемой Блома распределения ключевой информации.
.PP
Команда \fBkey\fR позволяет сохранять секретные ключи в файлы или
ключевое хранилище в контейнере, формат которого является открытым
и распространяется вместе с документацией к библиотеке \fBlibakrypt\fR.
Перед сохранением секретного ключа пользователю предлагается
ввести пароль, используемый для шифрования созданного секретного ключа.
Ввод пароля можно осуществлять как в символьном, так и в шестнацатеричном формате.
.PP
Вырабатываемые открытые ключи могут сохраняться как в формате запроса на сертификат,
так и в формате собственно сертификата в соответствии с рекомендациями
Р 1323565.1.23-2018. Также команда \fBkey\fR позволяет просматривать и
изменять параметры созданных ранее ключей.
.PP
.SS "Опции команды key"
.PP
\fB-a, --algorithm=\fR\fIметод\fR
.RS 2
Опция позволяет определить метод или алгоритм, используемый для генерации ключевой
информации. Для этого необходимо указать его имя или идентификатор.
Опция необходима в некоторых схемах выработки ключей, например, при использовании схемы Блома.
.RE
.PP
\fB-c, \--cert=\fR\fIфайл\fR
.RS 2
Опция подписывает созданный ранее запрос на сертификат открытого ключа и создает сертификат.
В качестве аргумента опции может выступать одно или несколько имен файлов,
содержащих запросы на сертификат. Также допускается использование шаблонов, например, \fB*.csr\fR.
В случае нескольких запросов они все будут подписаны одним и тем же ключом центра сертификации.
.RE
.PP
\fB--ca-cert=\fR\fIфайл\fR
.RS 2
Опция позволяет указать имя файла, содержащего сертификат открытого ключа центра сертификации.
Опция может использоваться для выработки и верификации пользовательских сертификатов.
.RE
.PP
\fB--ca-key=\fR\fIфайл\fR
.RS 2
Опция позволяет указать имя файла, содержащего секретный ключ центра сертификации.
Опция может применяться при генерации пользовательских сертификатов из запросов на сертификат.
Данная опция является другой формой опции \fB--key\fR.
.RE
.PP
\fB--curve=\fR\fIимя\fR
.RS 2
Опция позволяет указать имя или идентификатор эллиптической кривой,
которой принадлежит открытый ключ.
.RE
.PP
\fB\--days=\fR\fIчисло\fR
.RS 2
Опция позволяет определить срок действия секретного или открытого ключа.
Срок исчисляется заданным количеством дней, начиная с момента вызова утилиты.
.RE
.PP
\fB\--field=[\fR\fI256,512\fR\fB]\fR
.RS 2
Опция позволяет указать степень расширения конечного поля, в битах, используемого для реализации
криптографических алгоритмов. Допустимыми аргументами опции являются значения 256 или 512.
.RE
.PP
\fB\--format=\fR\fIформат\fR
.RS 2
Опция позволяет указать формат хранения вырабатываемого файла с ключевой информацией.
Допустимыми аргументами опции являются значения \fIder\fR, \fIpem\fR или \fIcertificate\fR.
.RE
.PP
\fB\--id=\fR\fIстрока\fR
.RS 2
Опция позволяет определить имя или идентификатор владельца ключа. В случае использования
данной опции одовременно с созданием сертификата открытого ключа или запроса на сертификат
значение \fIстрока\fR определяет расширенное имя владельца.
Расширенное имя владельца должно состоять из последовательности секций вида
\fI"/секция1=значение1/секция2=значение2"\fR,
где название секции должно принимать значение из множества:
.IP \[bu] 2
\fIem\fR (электронная почта), \fIcn\fR (основное имя), \fIct\fR (страна),
\fIst\fR (область),
\fIlt\fR (поселение),
\fIsa\fR (улица),
\fIor\fR (организация), \fIou\fR (отдел), \fItl\fR (должность),
\fIsu\fR (фамилия), \fIgn\fR (имя), \fIps\fR (псевдоним) и \fIsn\fR (серийный номер).
.PP
Также поддерживаются названия секций, рекомендованные для использования в Российской Федерации
.IP \[bu] 2
\fIog\fR (ОГРН), \fIoi\fR (ОГРНИП), \fIsi\fR (СНИЛС), \fIin\fR (ИНН физического лица) и \fIle\fR (ИНН юридического лица).
.RE
.PP
\fB\--id-hex=\fR\fIстрока\fR
.RS 2
Опция позволяет указать имя владельца секретного ключа в виде шестнадцатеричной последовательности.
Данная опция не применяется при выработке сертификатов или запросов на сертификат открытого ключа.
.RE
.PP
\fB\--inpass=\fR\fIстрока\fR
.RS 2
Опция позволяет указать пароль доступа к считываемому секретному ключу в командной строке.
Использование данной опции может привести к компрометации ключевой информации.
.RE
.PP
\fB\--inpass-hex=\fR\fIстрока\fR
.RS 2
Опция позволяет указать пароль доступа к считываемому секретному ключу в командной строке
в виде шестнадцатеричной последовательности.
Использование данной опции может привести к компрометации ключевой информации.
.RE
.PP
\fB\--key=\fR\fIфайл\fR
.RS 2
Опция позволяет указать имя файла, содержащего считываемый секретный ключ
симметричного или асимметричного алгоритма.
.RE
.PP
\fB\--label=\fR\fIстрока\fR
.RS 2
Опция позволяет присвоить секретному ключу пользовательскую метку или описание.
.RE
.PP
\fB\-n, \--new\fR
.RS 2
Опция создает новый секретный ключ или ключевую пару для заданного криптографичеспкого алгоритма.
.RE
.PP
\fB\--op\fR
.RS 2
Короткая форма опции \fB--output-public-key\fR.
.RE
.PP
\fB\--outpass=\fR\fIстрока\fR
.RS 2
Опция позволяет указать пароль доступа к созданному секретному ключу прямо в командной строке.
Использование данной опции может привести к компрометации ключевой ифнормации.
.RE
.PP
\fB\--outpass-hex=\fR\fIстрока\fR
.RS 2
Опция позволяет указать пароль доступа к созданному секретному ключу прямо в командной строке
в виде шестнадцатеричной последовательности.
Использование данной опции может привести к компрометации ключевой ифнормации.
.RE
.PP
\fB\--output-public-key=\fR\fIфайл\fR
.RS 2
Опция позволяет указать имя файла, в котором будет сохранен созданный сертификат или
запрос на сертификат открытого ключа. Имеет короткую форму \fB--op\fR.
.RE
.PP
\fB\-o, \--output-secret-key=\fR\fIфайл\fR
.RS 2
Опция позволяет указать имя файла, в котором будет сохранен созданный секретный ключ.
.RE
.PP
\fB\--p7b-create=\fR\fIсертификат1 сертификат2 ...\fR
.RS 2
Опция позволяет поместить один или несколько сертификатов центра сертификации в один контейнер
в формате PKCS #7 (обычно используется расширение p7b).
.RE
.PP
\fB\--p7b-ls=\fR\fIфайл\fR
.RS 2
Опция позволяет вывести в консоль список сертификатов,
хранящихся в контейнере PKCS #7.
.RE
.PP
\fB\--p7b-split=\fR\fIфайл\fR
.RS 2
Опция позволяет извлечь из контейнера в формате PKCS #7
все доступные сертификаты и сохранить их в виде отдельных файлов (в кодировке \fIder\fR или \fIpem\fR).
.RE
.PP
\fB\--random=\fR\fIимя\fR
.RS 2
Опция позволяет указать имя или идентификатор генератора псевдослучайных последовательностей,
используемого для выработки ключевой информации или электронной подписи.
По умолчанию устанавливается генератор, зависящий от операционной системы, в которой выполняется утилита.
В ОС Linux это генератор, доступ к которому обеспечивается символьным устройством \fI\[rs]dev\[rs]random\fR.
.RE
.PP
\fB\--random-file=\fR\fIфайл\fR
.RS 2
Опция позволяет в явном виде указать имя файла из которого происходит чтение псевдослучайных последовательностей.
Использование данной опции целесообразно для доступа к физическим генераторам, предоставляющим доступ к вырабатываемым
данным посредством символьных устройств.
.RE
.PP
\fB\--repo\fR
.RS 2
Опция указывает путь к хранилищу доверенных сертификатов.
Если опция не указана, используется установленный по-умолчанию каталог
(в Unix-системах это может быть \fI\[rs]usr\[rs]share\[rs]ca-certificate\[rs]libakrypt\fR).
.RE
.PP
\fB\--repo-add=\fIфайл\fR
.RS 2
Опция добавляет сертификат в хранилище доверенных сертификатов.
В качестве аргумента опции может выступать как \fIфайл\fR с сертификатом ключа (в pem или der-кодировке),
так и контейнер сертификатов в формате PKCS #7 (обычно используется расширение p7b).
Для записи могут потребоваться права доступа к хранилищу.
.RE
.PP
\fB\--repo-check\fR
.RS 2
Опция проверяет валидность всех сертификатов, содержащихся в хранилище доверенных сертификатов.
При необходимости, функция приводит имена и форматы хранения сертификатов к единому виду: \fBсерийный_номер.cer\fR,
а также удаляет из хранилища лишние файлы и невалидные сертификаты.
Для удаления данных могут потребоваться права доступа к хранилищу.
.RE
.PP
\fB\--repo-ls\fR
.RS 2
Опция выводит список доверенных сертификатов, находящихся
в ключевом хранилище.
.RE
.PP
\fB\--repo-rm=\fIсрока\fR
.RS 2
Опция удаляет из хранилища доверенных сертификатов те сертификаты,
в серийных номерах которых содержится указанная \fIстрока\fR.
Длина строки должна быть не менее 6 символов.
.RE
.PP
\fB\--secret-key-number=\fR\fIстрока\fR
.RS 2
Опция позволяет указать в явном виде номер секретного ключа (как строку, состоящую не более чем из 64 шестнадцатеричных символов).
Данный номер может быть использован при создании новых секретных ключей, а также при
создании сертификатов открытых ключей с расширением, задаваемым опцией \fB--key-encipherment\fB.
.RE

.PP
\fB\-s, \--show=\fR\fIфайл\fR
.RS 2
Опция позволяет вывести в простом текстовом формате
значения параметров секретного ключа (симметричного или асимметричного).
.RE
.PP
\fB\--show-algorithm=\fR\fIфайл\fR
.RS 2
Опция позволяет вывести идентификатор алгоритма, для которого предназначен секретный ключ.
.RE
.PP
\fB\--show-curve=\fR\fIфайл\fR
.RS 2
Опция позволяет вывести идентификатор эллиптической кривой, которой принадлежит
открытый ключ, соответствующий указанному секретному ключу. Результат определен только для
секретных ключей асимметричных алгоритмов.
.RE
.PP
\fB\--show-label=\fR\fIфайл\fR
.RS 2
Опция позволяет вывести метку секретного ключа.
.RE
.PP
\fB\--show-number=\fR\fIфайл\fR
.RS 2
Опция позволяет вывести уникальный номер секретного ключа.
.RE
.PP
\fB\--show-public-key=\fR\fIфайл\fR
.RS 2
Опция позволяет вывести уникальный номер открытого ключа,
соответствующего указанному секретному ключу. Результат определен только для
секретных ключей асимметричных алгоритмов.
.RE
.PP
\fB\--show-resource=\fR\fIфайл\fR
.RS 2
Опция позволяет вывести оставшийся ресурс секретного ключа.
.RE

.PP
\fB\--size=[\fR\fI1, .., 4096\fR\fB]\fR
.RS 2
Опция позволяет указать размер ключевого множества для создаваемого секретного ключа, например, в схеме Блома.
Максимально допустимым значением в настоящее время является величина 4096.
.RE
.PP
\fB\-t, \--target=\fR\fIимя\fR
.RS 2
Опция позволяет указать имя криптографического алгоритма для которого предназначается создаваемый секретный ключ.
Для генерации простой незашифрованной последовательности заданного размера, не связанной ни с каким криптографическим алгоритмом,
в качестве имени алгоритма должна быть указана строка \fIundefined\fR.
.RE
.PP
\fB\--to\fR
.RS 2
Короткая форма опции \fB--format\fR.
.RE
.PP
\fB\-v, \--verify=\fR\fIфайл\fR
.RS 2
Опция выполняет верификацию открытого ключа,
который может быть задан в виде сертификата, запроса на сертификат открытого ключа или контейнера сертификатов
в формате PKCS #7 (обычно используется расширение p7b).
В качестве параметров опции может быть указан один или несколько файлов, а также шаблон, например, \fB*.crt\fR.
Если указана опция \fB--verbose\fR, то утилита выводит значение открытого ключа в консоль.
.RE
.PP
Далее указаны опции, которые могут быть использованы для управления расширениями сертификатов открытых ключей.
.RE
.PP
\fB\--authority-name\fR
.RS 2
Опция добавляет в расширение \fIAuthorityKeyIdentifier\fR расширенное имя центра сертификации.
По умолчанию данная возможность отключена.
.RE
.PP
\fB\--ca\fR
.RS 2
Опция объединяет в себе вызов двух опций: \fB--ca-ext=\fR\fItrue\fR и \fB--key-cert-sign\fR.
Должна использоваться при создании сертифката открытого ключа центра сертификации.
.RE
.PP
\fB\--ca-ext=\fR\fIзначение\fR
.RS 2
Опция позволяет указать, может ли создаваемый сертификат открытого ключа
являться сертификатом центра сертификации.
Допустимыми значениями опции могут являться значения \fItrue\fR или \fIfalse\fR.
.RE
.PP
\fB\--pathlen=\fR\fIчисло\fR
.RS 2
Опция устанавливает максимальную длину цепочки сертификации.
Имеет смысл только одновремено со значением \fB--ca-ext=\fItrue\fR.
.RE
.PP
\fB\--digital-signature\fR
.RS 2
Опция разрешает использование открытого ключа для проверки электронной подписи под пользовательскими данными
(в расширение \fIKeyUsage\fR добавляется бит \fBDigital Signature\fR)
.RE
.PP
\fB\--key-encipherment\fR
.RS 2
Опция разрешает использование открытого ключа для зашифрования ключевой информации
(в расширение \fIKeyUsage\fR добавляется бит \fBKey Encipherment\fR)
.RE
.PP
\fB\--data-encipherment\fR
.RS 2
Опция разрешает использование открытого ключа для зашифрования пользовательских данных
(в расширение \fIKeyUsage\fR добавляется бит \fBData Encipherment\fR)
.RE
.PP
\fB\--key-agreement\fR
.RS 2
Опция разрешает использование открытого ключа в протоколах выработки ключевой информации
(в расширение \fIKeyUsage\fR добавляется бит \fBKey Agreement\fR)
.RE
.PP
\fB\--key-cert-sign\fR
.RS 2
Опция разрешает использование открытого ключа для проверки подписи под сертификатами открытых ключей
(соответствующий секретный ключ может быть использован для выработки подписи под сертификатами открытых ключей)
(в расширение \fIKeyUsage\fR добавляется бит \fBCertificate Sign\fR)
.RE
.PP
\fB\--crl-sign\fR
.RS 2
Опция разрешает использование открытого ключа для проверки подписи под списками отозванных сертификатов
(в расширение \fIKeyUsage\fR добавляется бит \fBCRL Sign\fR)
.RE
.PP
.SS "Примеры выработки ключей симметричных криптографических алгоритмов"
.PP
Создать секретный ключ алгоритма блочного шифрования Магма можно с помощью следующей команды.
.IP
.nf
\f[C]
aktool k -nt magma -o magma.key
\f[R]
.fi
.RE
.PP
В процессе выполнения указанной команды пользователю будет предложено ввести пароль,
на котором будет зашифрованно значение созданного ключа. С использованием опции \fB--outpass\fR
пароль можно определить прямо в командной строке.
.PP
Аналогично, создание нового ключа выработки имитовставки для алгоритма \fIhmac256-streebog256\fR
с использованием случайных значений из символьного устройства \fB\[rs]dev\[rs]random\fR
можно выполнить с помощью следующего вызова.
.IP
.nf
\f[C]
aktool k -nt hmac-streebog256 -o secret-hmac256.key \\
   --label "used for testing purpose" --random-file /dev/random
\f[R]
.fi
.RE
.PP
Созданный ключ будет помечен
меткой \fIused for testing purpose\fR и сохранен в файл \fIsecret-hmac256.key\fR. Посмотреть
информацию о созданном ключе можно с помощью одного из следующих вызовов.
.IP
.nf
\f[C]
aktool k -s secret-hmac256.key
aktool a secret-hmac256.key
\f[R]
.fi
.RE
.PP
В первом случае будет выведена информация о параметрах созданного ключа в виде простой
таблицы следующего вида
.IP
.nf
\f[C]
Тип:
   Симметричный секретный ключ
Алгоритм:
   hmac function (hmac-streebog256, 1.2.643.7.1.1.4.1)
Номер:
   64fd34212dad3aa2d6e3c1646237b0ab6a167833aa018aa251f6b6b9b6328a2c
Ресурс: 65536 (key usage resource)
   от: 25 янв 2021 23:03:51 (Понедельник) MSK
   до: 25 янв 2022 23:03:51 (Вторник) MSK
Метка:
   used for testing purpose
\f[R]
.fi
.RE
.PP
Во втором случае будет выведена ASN.1 структура,
содержащая, в частности, зашифрованное значение созданного ранее ключа.
.PP
.SS "Примеры выработки ключевых пар и сертификатов открытых ключей"
.PP
Выработка ключевой пары должна производиться с явным указаним алгоритма электронной подписи.
Например, ключевая пара для алгоритма ГОСТ Р 34.10-2012 может быть выработана
с помощью следующего вызова
.IP
.nf
\f[C]
aktool k -nt sign256 -o aktool256.key --op aktool256_request.csr --to pem
\f[R]
.fi
.RE
.PP
В процессе выполнения утилиты будет запрошена и помещена в запрос на сертификат открытого ключа
информация о владельце создаваемого ключа. Созданый запрос будет сохранен в формате \fIpem\fR
(текстовый файл, содержащий двоичную последовательность в кодировке \fIbase64\fR).
Посмотреть содержимое созданных ключей можно следующим образом.
.IP
.nf
\f[C]
aktool k -s aktool256.key
aktool k -v aktool256_request.csr --verbose
\f[R]
.fi
.RE
.PP
Для явного определения эллиптической кривой, которой принадлежит создаваемый открытый ключ,
можно воспользоваться опцией \fB--curve\fR.
Для явного указания информации о владельце ключа можно воспользоваться опцией \fB--id\fR.
.PP
В следующем примере создается ключевая пара и открытый ключ помещается в самоподписаный сертификат.
Синтаксис команды отличается от предыдущего только явным указанием эллиптической кривой и
аргументом опции \fB--to\fR.
.IP
.nf
\f[C]
aktool k -nt sign512 --curve ec512b -o aktool512.key --op aktool512_ca.crt \[rs]
  --to certificate --id "/cn=Aktool Authority Team"
\f[R]
.fi
.RE
.PP
Для подписи запроса на сертификат можно воспользоваться следующей командой.
.IP
.nf
\f[C]
aktool k -c aktool256_request.csr --ca-key aktool512.key \[rs]
  --ca-cert aktool512_ca.crt --op aktool256_certificate.crt --to pem
\f[R]
.fi
.RE
.PP
Для верификации и просмотра созданных сертификатов можно воспользоваться следующими командами.
.IP
.nf
\f[C]
aktool k -v aktool256_request.csr --verbose
aktool k -v aktool256_certificate.crt --ca-cert aktool512_ca.crt --verbose
\f[R]
.fi
.RE
.PP
Следующая команда помещает сертификат удостоверяющего центра в хранилище
доверенных сертификатов. Это позволит функциям библиотеки находить
открытый ключ без дополнительных указаний со стороны пользователя.
.IP
.nf
\f[C]
aktool k --repo-add aktool512_ca.crt
\f[R]
.fi
.RE
.PP
В качестве примеров для работы с контейнерами сертификатов в формате PKCS #7 (обычно используется расширение p7b),
могут быть использованы следующие команды:
.IP
.nf
\f[C]
aktool k --p7b-create ca*.cer --op cacer.p7b --to pem
aktool k --p7b-ls cacer.p7b
aktool k -v cacer.p7b
aktool k --repo-add cacer.p7b
\f[R]
.fi
.RE
.PP
В первом примере утилита помещает все валидные сертфикаты, имена которых удовлетворяют
шаблону поиска \fIca*.cer\fR, в контейнер с заданным именем \fIcacer.p7b\fR
в текстовом формате (с использованием кодировки base64).
Далее, содержимое контейнера выводится в консоль, верифицируется и добавляется в хранидище доверенных сертификатов.
.PP
Добавим, что в состав исходных текстов библиотеки входит набор тестовых скриптов
(каталог scripts), содержащий большое количество примеров использования утилиты \fBaktool\fR
для выработки и верификации сертификатов открытых ключей.
.PP
.SS "Примеры выработки ключевой информации в схеме Блома"
.PP
Для генерации ключей парной связи (общих симметричных ключей) в схеме Блома необходимо выработать
мастер-ключ, представляющий собой квадратную матрицу из элементов конечного
поля GF(2^n) для \fIn\fR равного 256 или 512 бит.
Выработать мастер-ключ можно с помощью следующего вызова, явно указав
имя алгоритма генерации ключей: \fIblom-master\fR или \fIblom-matrix\fR.
.IP
.nf
\f[C]
aktool k -na blom-master --size 512 --field 256 -o master.key
\f[R]
.fi
.RE
.PP
В приведенном примере размер вырабатываемой матрицы составляет 512x512 элементов.
Матрица сохраняется в файл \fImaster.key\fR (Следует заметить,
что размер вырабатываемого мастер-ключа должен
составлять 32 + `size` x (`size` + 1 ) x `field` / 16 октетов;
для приведенного примера размер будет составлять \fB4202528\fR октетов).
.PP
Для выработки ключа абонента с идентификатором \fIIDa\fR необходимо выполнить команду
.IP
.nf
\f[C]
aktool k -na blom-user --key master.key -o IDa.key --id IDa
\f[R]
.fi
.RE
.PP
Выработанный ключ будет помещен в файл \fIIDa.key\fR.
.PP
Для выработки ключа, который будет использован абонентом с идентификатором \fIIDa\fR для связи
с абонентом, имеющим идентификатор \fIIDb\fR, необходимо выполнить следующую команду.
.IP
.nf
\f[C]
aktool k -na blom-pairwise --key IDa.key --id IDb -o pairwise-ab.plain --target undefined
\f[R]
.fi
.RE
.PP
Значение опции \fB--target\fR говорит о том, что выработанный ключ парной связи
будет сохранен в файле \fIpairwise-ab.plain\fR в незашифрованом виде.
Тот же ключ может быть выработан и сохранен в формате контейнера библиотеки следующим образом.
.IP
.nf
\f[C]
aktool k -na blom-pairwise --key IDa.key --id IDb -o pairwise-ab.key \[rs]
  --target kuznechik --to pem --label "used for testing purpose"
\f[R]
.fi
.RE
.PP
В этом случае, будет сформирован полноценный контейнер, содержащий мета-информацию
о ключе парной связи. Полученный файл может быть просмотрен, например, с помощью программы \fBcat\fR
и будет иметь следующий вид.
.IP
.nf
\f[C]
-----BEGIN ENCRYPTED SYMMETRIC KEY-----
MIIBOQYJKoUDAjQBfwEBMEkGCSqFAwI0AX8CATA8BggqhQMHAQEFAjAwBggqhQMH
AQEEAgQgAHB+xvFnuFDcr1hjTVoOzg9mrjHog+W2YMkA2nuFqiQCAgfQMIHgBgkq
hQMCNAF/AwEwgdIGCCqFAwcBAQUCBCCvdnxc1dJHhBjMc9fJCRAheXilh54enght
QJrU2UlDEwwYdXNlZCBmb3IgdGVzdGluZyBwdXJwb3NlMCgCAQACAyAAADAeFw0y
MDEyMTkyMjU3NTdaFw0yMTEyMTkyMjU3NTdaMGACAQECAQAEWGA2LJdbqSbk99Wu
vjPwoBcA/PmKb1hI8cIj9GwbbZljdGkDUvjwO1DgnfAsc7u/Fkumtvy/i/ejQEu/
o2Mg5v5P8bJwA0SCk+XRLluRmNYVsAYS8egjFXM=
-----END ENCRYPTED SYMMETRIC KEY-----
\f[R]
.fi
.RE
.PP
Добавим, что следующая последовательность команд может быть использована
абонентом с идентификатором \fIIDb\fR для получения ключа парной связи с абонентом,
связанным с идентификатором \fIIDa\fR.
.IP
.nf
\f[C]
aktool k -na blom-user --key master.key -o IDb.key --id IDb
aktool k -na blom-pairwise --key IDb.key --id IDa -o pairwise-ba.plain --target undefined
\f[R]
.fi
.RE
.PP
В результате для абонента с идентификатором \fIIDb\fR будет получен ключ парной связи \fIpairwise-ba.plain\fR
который, как легко проверить, побайтно совпадает с выработанным ранее для абонента
с идентификатором \fIIDa\fR ключом \fIpairwise-ab.plain\fR.
.IP
.nf
\f[C]
xxd -g1 pairwise-ab.plain
00000000: e2 fd af 33 30 55 22 b3 45 fd 2f 06 2b 91 45 50  ...30U".E./.+.EP
00000010: f5 70 a6 0d 3f 78 f7 0d 9e c4 41 b2 7b 5b f1 6b  .p..?x....A.{[.k

xxd -g1 pairwise-ba.plain
00000000: e2 fd af 33 30 55 22 b3 45 fd 2f 06 2b 91 45 50  ...30U".E./.+.EP
00000010: f5 70 a6 0d 3f 78 f7 0d 9e c4 41 b2 7b 5b f1 6b  .p..?x....A.{[.k
\f[R]
.fi
.RE
.PP
.\"
.\" ----------------------------------------------------------------------------------------------- .\"
.SH "КОНТРОЛЬ ЦЕЛОСТНОСТИ"
.SS "Общее описание"
.PP
Команда \fBicode\fR (короткая форма \fBi\fR) позволяет вычислять контрольные суммы или имитовставки
для одного или нескольких файлов.
.PP
Для вычисления контрольных сумм
могут быть использованы любые реализованные в библиотеке алгоритмы бесключевого чтения, например,
алгоритм Стрибог512.
.PP
Для вычисления имитовставки необходимо использовать созданный ранее секретный ключ.
Данный ключ должен быть предварительно создан пользователем с использованием команды \fBkey\fR
или указан в явном виде в командной строке (исключительно для тестирования совместимости с библиотекой openssl).
.PP
В настоящее время для вычисления имитовставки могут быть использованы следующие алгоритмы
.IP \[bu] 2
алгоритм \fBcmac\fR, регламентируемый ГОСТ Р 34.13-2015,
.IP \[bu] 2
алгоритм \fBhmac\fR, регламентируемый Р 1323565.1.113-2016.
.PP
Поскольку некоторые алгоритмы вычисления имитовставки накладывают
ограничения на объем информации, обрабатываемой на одном ключе, то для
таких алгоритмов вычисление имитоставки от очень больших
файлов может приводить к ошибке. Если Вам необходимо вычислять
имитовставки файлов с произвольной, сколь угодно большой длиной, то
используйте следующие алгоритмы: \fIhmac-streebog256\fR, \fIhmac-streebog512\fR.
.PP
.SS "Опции команды icode"
.PP
\fB-a, \--algorithm=\fR\fIметод\fR
.RS 2
Опция позволяет указать метод вычисления контрольной суммы (алгоритма бесключевого хеширования).
В качестве параметра опции может выступать имя алгоритма, например \fIstreebog512\fR, или идентификатор
алгоритма \- последовательность целых чисел, разделенный точками.
В случае, когда опция не определена, для вычисления контрольной суммы
используется бесключевая функция хеширования \fIstreebog256\fR.
В случае выработки имитовставки данная опция может быть опущена.
.RE
.PP
\fB-c, \--check=\fR\fIфайл\fR
.RS 2
Опция позволяет проверить контрольные суммы или имитовставки для
одного или нескольких файлов. Данные суммы должны быть вычислены
заранее и сохранены в указанном \fIфайле\fR. Если при проверке используется
алгоритм, отличный от установленного по-умолчанию, необходимо указать
его имя или идентификатор (для алгоритмов хеширования), а также, при необходимости,
используемый секретный ключ.
.RE
.PP
\fB\--dont-show-stat\fR
.RS 2
Опция запрещает вывод в консоль статистической информации об общем
количестве проверенных файлов, количестве успешных или неуспешных
проверок и т.п. Используется только совместно с опцией \fB--check\fR.
.RE
.PP
\fB\--ignore-errors\fR
.RS 2
Опция запрещает останавливать процесс проверки контрольных сумм или
имитовставок в случае возникновения ошибок доступа или чтения
файлов, отсутствия файлов, содержащихся в списке и т.п.
Используется только совместно с опцией \fB--check\fR.
.RE
.PP
\fB\--inpass=\fR\fIстрока\fR
.RS 2
Опция позволяет указать пароль доступа к считываемому секретному ключу в командной строке.
Использование данной опции может привести к компрометации ключевой информации.
.RE
.PP
\fB\--inpass-hex=\fR\fIстрока\fR
.RS 2
Опция позволяет указать пароль доступа к считываемому секретному ключу в командной строке
в виде шестнадцатеричной последовательности.
Использование данной опции может привести к компрометации ключевой информации.
.RE
.PP
\fB\--key=\fR\fIфайл\fR
.RS 2
Опция позволяет указать имя файла, содержащего считываемый секретный ключ
алгоритма выработки имитовставки.
.RE
.PP
\fB-m, \--mode=\fR\fIрежим\fR
.RS 2
Опция позволяет уточнить алгоритм вычисления имитовставки (\fBcmac\fR, \fBomac-acpkm\fR и т.п.),
реализуемый с использованием определяемого секретным ключом алгоритма блочного шифрования.
При вычислении котрольных сумм, а также при использовании алгоритмов семейства \fBhmac\fR,
данная опция не применяется.
.RE
.PP
\fB\--no-derive\fR
.RS 2
По-умолчанию, для вычисления имитовставки вырабатывается производный ключ,
зависящий от указанного опцией \fB--key\fR исходного ключа и имени имитозащищаемого файла. Использование данной опции
приводит к запрету вычисления производного ключа и вычислению имитовставки на исходном ключе.
.RE
.PP
\fB-o, \--output=\fR\fIфайл\fR
.RS 2
Опция определяет имя файла, в который записываются вычисленные
значения контрольных сумм или имитовставок. Данный файл может быть
указан в качестве параметра опции \fB--check\fR.
.RE
.PP
\fB-p, \--pattern=\fR\fIстрока\fR
.RS 2
Опция указывает шаблон (маску) поиска файлов, к которым применяется процедура
вычисления контрольной суммы или имитовставки.
.RE
.PP
\fB-r, \--recursive\fR
.RS 2
Опция указывает, что при вычислении контрольных сумм или
имитовставок, должна выполняться рекурсивная процедура обхода
текущего и всех вложенных каталогов. Опция имеет смысл только в том
случае, когда в аргументах вызова утилиты указано имя каталога.
.RE
.PP
\fB\--reverse-order\fR
.RS 2
Опция указывает, что все выводимые и вводимые последовательности
октетов, должны обрабатываться в обратном порядке. Использование
данной опции целесообразно для вывода результатов в \fIbig endian\fR
порядке следования октетов.
.RE
.PP
\fB\--seed=\fR\fIстрока\fR
.RS 2
При генерации производных ключей используется криптографическая функция, инициализируемая двумя значениями \- именем файла и
заданной \fIстрокой\fR. В случае, если данная опция не указана, то используется определяемое утилитой
фиксированное значение.
.RE
.PP
\fB\--tag\fR
.RS 2
Опция указывает, что значения контрольных сумм или имитовставок
должны выводиться в формате, принятом в операционных системах
семейства BSD. В таком формате указывается не только имя файла и его
контрольная сумма или имитовставка, но и алгоритм, с помощью которого данная сумма
была посчитана.
.RE
.PP
.SS "Примеры использования команды icode"
.PP
Приведимый ниже вызов утилиты позволяет вычислить контрольную сумму файла
\fIfile.txt\fR с помощью установленного по умолчанию алгоритма \fIstreebog256\fR
и помещает результат вычислений в файл \fIresult.txt\fR.
.IP
.nf
\f[C]
aktool i file.txt -o result.txt
\f[R]
.fi
.RE
.PP
Следующая последовательность вызовов позволяет вычислить имитовставки всех файлов,
удовлетворяющих шаблону \fI\*.t??\fR (файлы, имеющие расширение из трех
символов, начинающееся с символа t) в текущем каталоге (на это указывает
символ \fI.\fR), а также во всех доступных вложенных каталогах. Для
вычисления кода целостности используется алгоритм выработки имитовставки
ГОСТ Р 34.13-2015 в основе которого лежит блочный шифр \fIkuznechik\fR.
.IP
.nf
\f[C]
aktool k -nt kuznechik -o kuznechik.key
aktool i -rp "*.t??" --key kuznechik.key -m cmac-kuznechik .
\f[R]
.fi
.RE
.PP
Следующий вызов позволяет проверить контрольные суммы, содержащиеся в
выработанном ранее файле \fIresult.txt\fR.
.IP
.nf
\f[C]
aktool i -c result.txt
\f[R]
.fi
.RE
.PP
В состав исходных текстов библиотеки входит набор тестовых скриптов
(каталог scripts), содержащий большое количество примеров использования утилиты \fBaktool\fR
для выработки и проверки контрольных сумм и кодов аутентификации.
.PP
.SS "Совместимость с другими программными средствами"
.PP
Известны две общедоступные утилиты, позволяющие вычислять контрольные
суммы с помощью отечественных алгоритмов хеширования. Этими утилитами
являются:
.PP
.IP \[bu] 2
\fBgost12sum\fR ( https://github.com/gost-engine/engine ), которая входит в
состав дополнительного модуля (engine) для хорошо известной программы
\fBopenssl\fR,
.IP \[bu] 2
\fBrhash\fR ( https://github.com/rhash/RHash ).
.PP
Следующая последовательность команд позволяет продемонстрировать
эквивалентность работы всех трех утилит для алгоритма хеширования
\fIstreebog256\fR.
.IP
.nf
\f[C]
echo -n hello > test.file
aktool i test.file
3fb0700a41ce6e41413ba764f98bf2135ba6ded516bea2fae8429cc5bdd46d6d test.file

rhash -G test.file
3fb0700a41ce6e41413ba764f98bf2135ba6ded516bea2fae8429cc5bdd46d6d test.file

gost12sum test.file
3fb0700a41ce6e41413ba764f98bf2135ba6ded516bea2fae8429cc5bdd46d6d test.file
\f[R]
.fi
.RE
.PP
Аналогично, для алгоритма хеширования \fIstreebog512\fR, запуск следующих
команд также позволит получить одинаковое значение хэш-кода размером 512 бит.
.IP
.nf
\f[C]
gost12sum -l test.file
rhash --gost12-512 test.file
aktool i -a streebog512 test.file
\f[R]
.fi
.RE
.PP
Программа \fBopenssl\fR также может вычислять контрольные суммы.
Например, следующий вызов позволит получить тот же результат, что и ранее,
но в другом формате.
.IP
.nf
\f[C]
openssl dgst -md_gost12_256 test.file > result.txt
cat result
md_gost12_256(test.file)=
    3fb0700a41ce6e41413ba764f98bf2135ba6ded516bea2fae8429cc5bdd46d6d
\f[R]
.fi
.RE
.PP
Утилита \fBaktool\fR может не только вырабатывать контрольные суммы в
таком же формате,
.IP
.nf
\f[C]
aktool i --tag test.file
streebog256 (test.file) =
   3fb0700a41ce6e41413ba764f98bf2135ba6ded516bea2fae8429cc5bdd46d6d
\f[R]
.fi
.RE
.PP
но и проверять файлы, подготовленные программой \fBopenssl\fR, используя
единый синтаксис командной строки.
.IP
.nf
\f[C]
aktool i -c result.txt --dont-show-stat
\f[R]
.fi
.RE
.PP
При имитозащите данных утилита \fBaktool\fR совместима с программой \fBopenssl\fR
только при использовании явно заданных секретных ключей. Следующие вызовы применяют
для вычисления имитовставки функцию \fIhmac-streebog256\fR и позволяют
получить одинаковый результат
.IP
.nf
\f[C]
openssl dgst -md_gost12_256 -mac hmac -macopt hexkey:acabdcab0137 test.file
HMAC-md_gost12_256(test.file)=
   31d56cc082c4cd57955119f4cde662b4554f867fcc08ee4d59ba32d0e604180d

aktool i -a hmac-streebog256 --hexkey acabdcab0137 --tag --no-derive test.file
hmac-streebog256 (test.file) =
   31d56cc082c4cd57955119f4cde662b4554f867fcc08ee4d59ba32d0e604180d
\f[R]
.fi
.RE
.PP
Отметим, что в данном случае секретный ключ, используемый для вычисления
имитовставки, задается явно, в виде последовательности шестнадцатеричных
символов. Максимальная длина последовательности не должна превышать 64
октета (128 шестнадцатеричных символа). Для последовательностей меньшей
длины старшие октеты заполняются нулями. Аналогичная совместимость
поддерживается при использовании функции \fIhmac-streebog512\fR.
.PP
.\"
.\" ----------------------------------------------------------------------------------------------- .\"
.\".SH "3. ШИФРОВАНИЕ ДАННЫХ"
.\".PP

.\"
.PP
.SH "РАЗБОР ДАННЫХ В ФОРМАТЕ ASN.1"
.PP
Команда \fBasn1parse\fR (коротка форма \fBa\fR) позволяет декодировать и выводить в консоль данные,
закодированные в формате ASN.1 дерева. В настоящее время
поддерживается разбор чистых der-последовательностей, а также
der-последовательностей, закодированных в кодировке \fIbase64\fR
(формат сертификатов \fIpem\fR).
.PP
.SS "Опции команды asn1parse"
.PP
\fB\--convert=\fIфайл\fR
.RS 2
Опция позволяет выполнить конвертацию ASN.1 данных между поддерживаемыми форматами,
т.е. перевести данные из der-формата в pem-формат и наоборот.
Преобразование, изменение или удаление данных из ASN.1 дерева при конвертации не производится.
.RE
.PP
\fB\--split=\fIфайл\fR
.RS 2
Опция позволяет разделить ASN.1 дерево на одну или несколько ветвей первого уровня.
После разделения каждая ветвь образует новое ASN.1 дерево и помещается в отдельный файл.
Опция может применяться для разделения коллекций сертификатов открытых ключей на
отдельные файлы.
.RE
.PP
\fB\-o, \--output=\fIфайл\fR
.RS 2
Опция позволяет в явном виде определить
имя файла в который будут помещены конверированные или объединенные данные.
Данную опцию имеет смысл использовать совместно с опциями \fB--convert\fR и \fB--join\fR.
.RE
.PP
\fB\--to=\fIформат\fR
.RS 2
Опция в явном виде указывает в каком формате должны быть сохранены данные.
Доступными значениями поля формат являются: \fIder\fR и \fIpem\fR.
.RE
.PP
\fB\--pem=\fIтип\fR
.RS 2
Опция в явном виде позволяет определить заголовок строки
в pem-файле, определяющий тип содержащихся далее данных.
Данную опцию имеет смысл использовать совместно с указанием опции  \fB--to=\fIpem\fR.
При значении \fB--to=\fIder\fR значение опции игнорируется.
.RE
.PP
.SS "Примеры использования"
.PP
Рассмотрим запрос на создание сертифката открытого ключа,
записанный в pem кодировке в файле \fIrequest_edw.pem\fR. Данный запрос
содержится в качестве примера в рекомендациях Р 1323565.1.023-2018, раздел А.2.2.1.
.IP
.nf
\f[C]
cat request_edw.pem

-----BEGIN CERTIFICATE-----
MIHKMHkCAQAwEjEQMA4GA1UEAxMHRXhhbXBsZTBeMBcGCCqFAwcBAQEBMAsGCSqF
AwcBAgEBAQNDAARAdCeV1L7ohN3yhQ/sA+o/rxhE4B2dpgtkUJOlXibfw5l49ZbP
TU0MbPHRiUPZRJPRa57AoW1RLS4SfMRpGmMY4qAAMAoGCCqFAwcBAQMCA0EAG9wq
Exdnm2YjL2PqFv98ZMyqua2FX8bhgJFmHbedSBIdDh2lvjR8bxtSVseurCAK1krH
em9bOg4Jcxjnrm7naQ==
-----END CERTIFICATE-----
\f[R]
.fi
.RE
.PP
Декодирование данного файла сможет быть выполнено с помощью следующего вызова.
.IP
.nf
\f[C]
aktool a request_edw.pem
\f[R]
.fi
.RE
.PP
В результате декодирования в консоль должна быть выведена следующая
иерархическая структура.
.IP
.nf
\f[C]
┌SEQUENCE┐
         ├SEQUENCE┐
         │        ├INTEGER 0x0
         │        ├SEQUENCE┐
         │        │        └SET┐
         │        │            └SEQUENCE┐
         │        │                     ├OBJECT IDENTIFIER 2.5.4.3
         │        │                     └PRINTABLE STRING Example
         │        ├SEQUENCE┐
         │        │        ├SEQUENCE┐
         │        │        │        ├OBJECT IDENTIFIER 1.2.643.7.1.1.1.1
         │        │        │        └SEQUENCE┐
         │        │        │                 └OBJECT IDENTIFIER 1.2.643.7.1.2.1.1.1
         │        │        └BIT STRING
         │        │           04 40 74 27 95 D4 BE E8 84 DD F2 85 0F EC 03 EA
         │        │           3F AF 18 44 E0 1D 9D A6 0B 64 50 93 A5 5E 26 DF
         │        │           C3 99 78 F5 96 CF 4D 4D 0C 6C F1 D1 89 43 D9 44
         │        │           93 D1 6B 9E C0 A1 6D 51 2D 2E 12 7C C4 69 1A 63
         │        │           18 E2
         │        └[0]┐
         │             (null)
         ├SEQUENCE┐
         │        └OBJECT IDENTIFIER 1.2.643.7.1.1.3.2
         └BIT STRING
            1B DC 2A 13 17 67 9B 66 23 2F 63 EA 16 FF 7C 64
            CC AA B9 AD 85 5F C6 E1 80 91 66 1D B7 9D 48 12
            1D 0E 1D A5 BE 34 7C 6F 1B 52 56 C7 AE AC 20 0A
            D6 4A C7 7A 6F 5B 3A 0E 09 73 18 E7 AE 6E E7 69
\f[R]
.fi
.RE
.PP
Следующий вызов демонстрирует
пример конвертирования ASN.1 дерева, сохраненного в виде
der-последовательности, в формат pem.
.IP
.nf
\f[C]
aktool a --convert request_edw.p10 --to pem --pem request -o request_edw.pem
\f[R]
.fi
.RE
.PP
Следующий вызов иллюстрирует, как можно разделить коллекцию сертификатов
\fIca-bundle.crt\fR на отдельные файлы.
.IP
.nf
\f[C]
aktool a --split ca-bundle.crt --to pem --pem certificate
\f[R]
.fi
.RE
.PP
.SH "ВЫВОД СЛУЖЕБНОЙ И ВСПОМОГАТЕЛЬНОЙ ИНФОРМАЦИИ"
.PP
Команда \fBshow\fR (короткая форма \fBs\fR) позволяет получить информацию о доступных
преобразованиях, параметрах криптографических ключей, значениях технических и
криптографических характеристик, а также параметрах библиотеки по-умолчанию. В
настоящий момент доступны следующие опции.
.PP
.SS "Опции команды show"
.PP
\fB\--curve=\fIимя\fR
.RS 2
Опция позволяет вывести в консоль параметры эллиптической кривой с заданным именем
или идентификатором.
.RE
.PP
\fB\--engines\fR
.RS 2
Опция позволяет вывести список всех типов криптографических
механизмов, которые могут быть использованы в приложениях библиотеки
\fBlibakrypt\fR. К таким типам, например, относятся блочные шифры или
алгоритмы выработки имитовставки.
.RE
.PP
\fB\--oid=\fIстрока\fR
.RS 2
Опция принимает в качестве параметра произвольную строку символов
и выводит все доступные
криптографические механизмы, в именах или идентификаторах которых
содержится указанная строка.
.RE
.PP
\fB\--oids\fR
.RS 2
Опция позволяет вывести список всех доступных криптографических
механизмов. Каждый механизм идентифицируется свои именем, которое
используется для его указания пользователем и/или
последовательностью чисел, разделенных точками. Последняя
последовательность называется \fIObject IDentifier\fR (OID) и используется
при автоматизированной обработке данных.
.RE
.PP
\fB\--options\fR
.RS 2
Опция выводит перечень всех криптографических параметров библиотеки,
а также их значений. К указанным параметрам относятся, например,
число блоков информации, которые могут быть зашифрованы на одном
ключе, или число итераций криптографической функции PBKDF2,
используемой для развертки ключа из пароля. Значения параметров
содержатся в файле \fIlibakrypt.conf\fR, расположенном либо в
системном каталоге (по-умолчанию, это \fI\[rs]etc\fR),
либо в домашнем каталоге пользователя (\fI${HOME}\[rs].config\[rs]libakrypt\fR).
.RE
.PP
\fB\--modes\fR
.RS 2
Опция позволяет вывести список всех режимов криптографических
преобразований, которыми могут быть охарактеризованы
криптографические преобразования. При этом одному типу криптографического
механизма может соответствовать несколько режимов. Например, функция
хеширования имеет режим \fIalgorithm\fR, а ее параметры \fIkbox params\fR.
.RE
.PP
\fB\--without-caption\fR
.RS 2
Опция запрещает печать заголовка, расшифровывающего названия
выводимых параметров и их значений.
.PP
.SS "Примеры использования"
.PP
Наиболее употребимым вариантом вызова команды \fBshow\fR является вызов
.IP
.nf
\f[C]
aktool s --oids
\f[R]
.fi
.RE
.PP
В результате данного вызова будет выведена информация
о всех доступных библиотеке \fBlibakrypt\fR криптографических преобразованиях.
Например, среди прочих, будет выведена  информация об алгоритме
блочного шифрования Кузнечик, см. ГОСТ Р 34.12-2015.
.IP
.nf
\f[C]
 N  oid                 name(s)          engine            mode
--------------------------------------------------------------------------
 9  1.2.643.7.1.1.5.2   kuznechik        block cipher      algorithm
                        kuznyechik
                        grasshopper
\f[R]
.fi
.RE
.PP
В данной таблице указаны:
.IP \[bu] 2
порядковый номер криптографического механизма,
.IP \[bu] 2
идентификатор (последовательность цифр, разделенных точками),
.IP \[bu] 2
перечень имен, с помощью которых пользователь может именовать криптографический механизм,
.IP \[bu] 2
тип криптографического механизма,
.IP \[bu] 2
режим использования.
.PP
Выборочный поиск можно осуществить с помощью опции \fB--oid\fR (без \fIs\fR на конце). Например,
следующий вызов позволяет найти все идентификаторы, имена которых
регламентированы Техническим комитетом "Криптографическая защита информации" (ТК26).
.IP
.nf
\f[C]
aktool s --oid tc26
\f[R]
.fi
.RE
.PP
Получить параметры эллиптической кривой можно с помощью следующего вызова.
.IP
.nf
\f[C]
aktool s --curve axeln0
\f[R]
.fi
.RE
.PP
После чего, в консоль будет выведена следующая информация.
.IP
.nf
\f[C]
curve: id-axel-gost-3410-2012-256-paramSetN0
       axeln0
oid:   1.2.643.2.52.1.12.1.1
forms:
   short Weierstrass form:   y^2 = x^3 + ax + b (mod p)
parameters:
   a =  0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd2158
   b =  0x42dfde56dd26bb76eba94ce9565e562bed1fb994675632a264afef327aa4e5ff
   p =  0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd215b
   q =  0xffffffffffffffffffffffffffffffff2c1b759991830c6b5dcc785b195c4edb
   c =  0x01 [cofactor]
point:
   px =  0x0000000000000000000000000000000000000000000000000000000000000002
   py =  0x011e47b6e40dc7f783b9f4fc84d085884b9b88ca9ec7da8c5567c9d87f68a17f
\f[R]
.fi
.RE
.PP
Перечень всех известных библиотеке идентификаторов эллиптических кривых
может быть получен с помощью следующего вызова.
.IP
.nf
\f[C]
aktool s --oid curve
\f[R]
.fi
.RE
.PP
.SH "ТЕСТИРОВАНИЕ КРИПТОГРАФИЧЕСКИХ АЛГОРИТМОВ"
.PP
Команда \fBtest\fR позволяет провести тестированние
корректности и скорости реализации криптографических алгоритмов.
.PP
.SS "Опции команды test"
.PP
\fB\--crypto\fR
.RS 2
Опция запускает процесс тестирования
всех реализованных в библиотеке \fBlibakrypt\fR
криптографических преобразований. В ходе тестирования
проверяется совпадение вычисляемых значений со значениями, приведенными в различных
регламетирующих документах (см., далее, раздел "СТАНДАРТЫ").
В ряде случае проверяется
совпадение результатов, полученных при помощи нескольких доступных реализаций.
.RE
.PP
\fB\--speed=\fIимя\fR
.RS 2
Опция позволяет запустить тест скорости
всех криптографических алгоритмов, в имени которых содержится заданная строка символов.
Поддерживается тестирование алгоритмов и режимов блочного шифрования,
тестирование алгоритмов хеширования данных и выработки электронной подписи.
Список доступных имен может быть получен с использованием команды \fBshow\fR.
.RE
.PP
.SS "Примеры использования"
.PP
Для запуска полного теста, с выводом информации об ошибках и выполняемях событиях,
достаточно выполнить следующую команду.
.IP
.nf
\f[C]
aktool test --crypto --audit 2 --audit-file stderr
\f[R]
.fi
.RE
.PP
Использованные в данном примере опции \fB--audit\fR и \fB--audit-file\fR рассматриваются
в следующем разделе.
.PP
Для запуска тестирования скорости работы
могут быть использованы следующие команды.
.IP
.nf
\f[C]
aktool test --speed magma
aktool test --speed ctr-kuznechik
aktool test --speed streebog256
aktool test --speed sign256
\f[R]
.fi
.RE
.PP
.SH "ОПЦИИ, ОБЩИЕ ДЛЯ ВСЕХ КОМАНД"
.PP
\fB\--audit=[\fI0,1,2\fB]\fR
.RS 2
Опция позволяет задать уровень вывода сообщений работы программы
(в виде целого неотрицательного числа). На уровне 0 выводятся только сообщения об ошибках.
Уровень 1 определяет минимальный набор выводимых сообщений сообщений,
в то время как уровень 2 позволяет вывести дополнительные сведения о
выполняющихся криптографических преобразованиях.
.RE
.PP
\fB\--audit-file=\fIфайл\fR
.RS 2
Опция позволяет определить файл, в который будут помещаться сообщения о процессе работы программы
и ошибках её выполнения. В случае, если аргумент опции принимает значение \fIstderr\fR,
то используется системный канал вывода ошибок.
.RE
.PP
\fB\--confirm\fR
.RS 2
Опция заставляет пользователя подтверждать удаление файлов.
.RE
.PP
\fB\--dont-use-colors\fR
.RS 2
По умолчанию для акцентирования внимания пользователя утилита использует цветовое выделение при
выводе некоторых данных. К таким данным относятся коды ошибок, сообщения об автоматическом
декодировании ASN.1 деревьев и т.п. Данная опция запрещает цветовое выделения.
.RE
.PP
\fB\--hex-input\fR
.RS 2
Опция указывает, что все вводимые с консоли пароли и идентификаторы должны интерпретироваться
как последовательности шестнадцатеричных символов.
.RE
.PP
\fB\--openssl-style\fR
.RS 2
Опция позволяет использовать нестандартизированные форматы представления данных
для некоторых криптографических алгоритмов, аналогично тому,
как они реализованы в библиотеке \fBopenssl\fR.
.RE
.PP
\fB\--quiet\fR
.RS 2
В случае использования опции программа не выводит ни каких сообщений. Результат ее работы
может быть получен с помощью кода возврата.
.RE
.PP
\fB\--verbose\fR
.RS 2
Опция позволяет вывести в консоль дополнительные сведения о выполняемых операциях.
Также опция расширяет перечень сообщений, выводимых с помощью установленной системы аудита.
.RE
.PP
.SS "Примеры использования"
.PP
Следующий вызов содержит
пример перенаправления вывода утилиты \fBaktool\fR с запрещением использования цвета
на вход программы просмотра \fBless\fR (запрет использования цвета убирает управляющие команды,
которые не могут быть обработаны утилитой просмотра).
.IP
.nf
\f[C]
aktool a 0408435EB90E5C8796A160E69E4BFAC453435D1D.cer --dont-use-colors | less
\f[R]
.fi
.RE
.PP
.SH СТАНДАРТЫ
.PP
\fBНациональные стандарты Российской Федерации\fR
.IP \[bu] 2
ГОСТ Р 34.10-2012 Процессы формирования и проверки электронной подписи,
.IP \[bu] 2
ГОСТ Р 34.11-2012 Функция хэширования,
.IP \[bu] 2
ГОСТ Р 34.12-2015 Блочные шифры,
.IP \[bu] 2
ГОСТ Р 34.13-2015 Режимы работы блочных шифров.
.RE
.PP
\fBРекомендации по стандартизации Росстандарта России\fR
.IP \[bu] 2
Р 50.1.111-2016 Парольная защита ключевой информации,
.IP \[bu] 2
Р 50.1.113-2016 Криптографические алгоритмы, сопутствующие применению алгоритмов электронной цифровой подписи и функции хэширования.
.IP \[bu] 2
Р 1323565.1.012-2017 Принципы разработки и модернизации шифровальных (криптографических) средств защиты информации.
.IP \[bu] 2
Р 1323565.1.017-2018 Криптографические алгоритмы, сопутствующие применению алгоритмов блочного шифрования.
.IP \[bu] 2
Р 1323565.1.023-2018 Использование алгоритмов ГОСТ Р 34.10-2012, ГОСТ Р 34.11-2012 в сертификате, списке аннулированных сертификатов (CRL) и запросе на сертификат PKCS #10 инфраструктуры открытых ключей X.509.
.IP \[bu] 2
Р 1323565.1.024–2019 Параметры эллиптических кривых для криптографических алгоритмов и протоколов.
.IP \[bu] 2
Р 1323565.1.026–2019 Режимы работы блочных шифров, реализующие аутентифицированное шифрование.
.RE
.PP
\fBRequests for Comments\fR
.IP \[bu] 2
RFC 5652. Cryptographic Message Syntax (CMS)
.\"
.SH "ИНФОРМАЦИЯ О ПРОЕКТЕ"
.PP
Интернет-сайт проекта: http://libakrypt.org
.PP
Исходные коды утилиты и библиотеки:
https://github.com/axelkenzo/libakrypt-0.x
.RE
.SH "АВТОРЫ"
Axel Kenzo & The Company Of Belles Lettres (с) 2014 - 2022.
